var SlideController={photos:null,photoId:0,slide:null,interval:null,intervalSeconds:5,borderSize:0,baseUrl:null,galleryId:0,galleryShare:0,playing:false,interval:null,tempImage:new Image(),initialize:function(e,d,c,b,a){SlideController.photoId=d||0;SlideController.baseUrl=c;SlideController.galleryId=b;SlideController.galleryShare=a;Event.observe(window,"load",function(){Event.observe(SlideController.tempImage,"load",function(){SlideController.photo.initSwap()});Event.observe($("Photo"),"load",function(){SlideController.photo.showPhoto()});SlideController.photos=e;SlideController.photo=new Slide(SlideController.photoId);SlideController.photo.initSwap();SlideController.play()})},play:function(){Element.hide("ssPlay");Element.show("ssPause");if(SlideController.interval){clearTimeout(SlideController.interval)}SlideController.interval=setTimeout(SlideController.next,SlideController.intervalSeconds*1000);SlideController.playing=true},pause:function(){Element.hide("ssPause");Element.show("ssPlay");if(SlideController.interval){clearTimeout(SlideController.interval)}SlideController.playing=false},prev:function(){SlideController.photo.prevPhoto()},next:function(){SlideController.photo.nextPhoto()}};Object.extend(Element,{getWidth:function(a){a=$(a);return a.offsetWidth},setWidth:function(b,a){b=$(b);b.style.width=a+"px"},setSrc:function(a,b){a=$(a);a.src=b},setHref:function(b,a){b=$(b);b.href=a},setInnerHTML:function(a,b){a=$(a);a.innerHTML=b},setOnClick:function(a,b){a=$(a);a.onclick=b}});var Slide=Class.create();Slide.prototype={initialize:function(a){this.photoId=a;this.photo="Photo";this.captionBox="CaptionContainer";this.caption="Caption"},setNewPhotoParams:function(){Element.setSrc(this.photo,SlideController.photos[SlideController.photoId][0]);Element.setInnerHTML(this.caption,SlideController.photos[SlideController.photoId][2]);try{document.title=document.title.replace(SlideController.photos[this.photoId][1],SlideController.photos[SlideController.photoId][1]);if(parent.frames.horde_main){parent.document.title=document.title}}catch(a){}},updateLinks:function(){var b="?gallery="+SlideController.galleryId+"&image="+SlideController.photos[SlideController.photoId][3]+"&page="+SlideController.photos[SlideController.photoId][4];Element.setInnerHTML("PhotoName",SlideController.photos[SlideController.photoId][1]);Element.setInnerHTML("breadcrumb_image",SlideController.photos[SlideController.photoId][1]);Element.setHref($("breadcrumb_image"),SlideController.baseUrl+"/view.php"+b+"&view=Image");Element.setHref($("breadcrumb_gallery"),SlideController.baseUrl+"/view.php"+b+"&view=Gallery");if($("image_properties_link")){Element.setHref("image_properties_link",SlideController.baseUrl+"/image.php"+b+"&actionID=modify&share="+SlideController.galleryShare);Element.setOnClick("image_properties_link",function(){SlideController.pause();popup(this.href);return false})}if($("image_edit_link")){Element.setHref("image_edit_link",SlideController.baseUrl+"/image.php"+b+"&actionID=editimage")}if($("image_ecard_link")){Element.setHref("image_ecard_link",SlideController.baseUrl+"/img/ecard.php?image="+SlideController.photos[SlideController.photoId][3]+"&gallery="+SlideController.galleryId);Element.setOnClick("image_ecard_link",function(){SlideController.pause();popup(this.href);return false})}if($("image_delete_link")){var a=function(){return window.confirm("Do you want to permanently delete "+SlideController.photos[SlideController.photoId][1])};Element.setHref($("image_delete_link"),SlideController.baseUrl+"/image.php"+b+"&actionID=delete");Element.setOnClick("image_delete_link",a)}Element.setHref("image_download_link",SlideController.baseUrl+"/img/download.php?image="+SlideController.photos[SlideController.photoId][3]);Element.setOnClick("image_download_link",function(){SlideController.pause()})},showPhoto:function(){new Effect.Appear(this.photo,{duration:1,queue:"end",afterFinish:(function(){Element.show(this.captionBox);this.updateLinks()}).bind(this)});if(SlideController.playing){if(SlideController.interval){clearTimeout(SlideController.interval)}SlideController.interval=setTimeout(SlideController.next,SlideController.intervalSeconds*1000)}},nextPhoto:function(){(SlideController.photoId==(SlideController.photos.length-1))?SlideController.photoId=0:++SlideController.photoId;SlideController.tempImage.src=SlideController.photos[SlideController.photoId][0]},prevPhoto:function(){(SlideController.photoId==0)?SlideController.photoId=SlideController.photos.length-1:--SlideController.photoId;SlideController.tempImage.src=SlideController.photos[SlideController.photoId][0]},initSwap:function(){new Effect.Fade(this.captionBox,{duration:0.5});new Effect.Fade(this.photo,{duration:1,afterFinish:(function(){SlideController.photo.setNewPhotoParams()})});this.photoId=SlideController.photoId}};document.observe("keydown",arrowHandler);function arrowHandler(a){if(a.altKey||a.shiftKey||a.ctrlKey){return}switch(a.keyCode||a.charCode){case Event.KEY_LEFT:SlideController.prev();break;case Event.KEY_RIGHT:SlideController.next();break}};